(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59],{8386:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return j}});var s=r(6687),n=r(9499),a=r(29),l=r(7794),i=r.n(l),c=r(7294),o=r(8325),d=r.n(o),m=(r(5433),r(4335),r(9980),r(6102),r(366),r(6854),r(9945),r(2503),r(4279),r(2731),r(6177),r(8759),r(2911),r(5206),r(6263),r(110),r(8533)),u=r(1163),p=r(3854),x=r(782),g=(r(4213),r(9008)),h=r.n(g),f=r(2918),y=r(5434),b=r(5893);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=!0;t.default=function(e){var t=e.blog,r=e.errorCode,l=(0,u.useRouter)(),o=l.query.slug,g=(0,c.useState)({comment:"",reply:""}),w=g[0],j=g[1],N=(0,c.useState)(),k=N[0],O=N[1],S=(0,c.useState)(),C=S[0],_=S[1],E=(0,c.useState)(0),P=E[0],T=E[1],A=(0,c.useState)(),B=A[0],D=A[1],I=(0,c.useState)({state:!0}),H=I[0],J=I[1],Z=(0,c.useState)(),z=Z[0],L=Z[1],M=(0,c.useState)(),q=M[0],F=M[1],R=(0,c.useState)(),U=R[0],V=R[1],W=(0,c.useState)(),X=W[0],Y=W[1],G=function(){var e=(0,a.Z)(i().mark((function e(){var t,r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.codewithharry.com/api/dataapi/getcomments?start="+P+"&end=5&search="+o);case 2:return t=e.sent,T(P+5),e.next=6,t.json();case 6:r=e.sent,B?(s=(s=JSON.parse(JSON.stringify(B))).concat(r.comments),D(s)):D(r.comments),_(r.pageLen);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,a.Z)(i().mark((function e(t){var r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.codewithharry.com/api/dataapi/getreplies?search="+t);case 2:return r=e.sent,e.next=5,r.json();case 5:s=e.sent,"all"===t?F(s):L(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){j(v(v({},w),{},(0,n.Z)({},e.target.name,e.target.value)))},$=function(){var e=(0,a.Z)(i().mark((function e(t){var r,n,a,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=JSON.parse(localStorage.getItem("cwhuser"))){e.next=5;break}return x.Am.error("You need to login first",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),e.abrupt("return");case 5:return n=t.target.id,e.next=8,fetch("https://www.codewithharry.com/api/postcomments",{method:"POST",headers:{"Content-Type":"application/json"},body:n?JSON.stringify({comment:w.reply,parent:n,token:r.token,blog:o,state:"published",securityToken:String(8*(new Date).getTime())}):JSON.stringify({comment:w.comment,token:r.token,blog:o,state:"published",securityToken:String(8*(new Date).getTime())})});case 8:return a=e.sent,j({comment:"",reply:""}),n?t.target.children[2].disabled=!0:t.target.children[0].children[2].children[0].children[0].disabled=!0,e.next=13,a.json();case 13:!0===(l=e.sent).success?(n?(L(z?function(e){return[].concat((0,s.Z)(e),[{comment:w.reply,parent:n,user:l.username,createdAt:(new Date).toJSON()}])}:[{comment:w.reply,parent:n,user:l.username,createdAt:(new Date).toJSON()}]),l.message="Reply Added!"):D((function(e){return[l.comment].concat((0,s.Z)(e))})),x.Am.success(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})):x.Am.error(l.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){setTimeout((function(){for(var e=document.getElementsByClassName("cwhads").length,t=0;t<e;t++){console.log("pushing");try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(r){}}}),0)}),[k]),(0,c.useEffect)((function(){Array.from(document.getElementsByClassName("copy-to-clipboard-button")).forEach((function(e){e.addEventListener("click",(function(e){e.target.innerText="Copied!";var t=e.target.parentElement.parentElement.parentElement.parentElement.getElementsByTagName("pre")[0].innerText;setTimeout((function(){e.target.innerText="Copy"}),1e3),navigator.clipboard.writeText(t)}))})),t&&O(function(e){var t=document.createElement("div");return t.innerHTML=e,d().manual=!0,d().highlightAllUnder(t),t.innerHTML}(t.content.replace(/&lt;\|AD\|&gt;/g,'<div class=\'cwhads my-4\'><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9655830461045889" data-ad-slot="8999979664" data-ad-format="auto" data-full-width-responsive="true"></ins></div>')))})),(0,c.useEffect)((function(){o&&G(),K("all");try{JSON.parse(localStorage.getItem("admin")).username||Y(!0)}catch(e){Y(!1)}}),[l.query]),!r&&!1!==t.is_published||X?(0,b.jsxs)(b.Fragment,{children:[t&&(0,b.jsxs)(h(),{children:[(0,b.jsxs)("title",{children:[t.title," | CodeWithHarry"]}),(0,b.jsx)("meta",{name:"description",content:t.metadesc}),(0,b.jsx)("link",{rel:"icon",href:"/img/favicon.ico"})]}),(0,b.jsx)(x.Ix,{}),U&&(0,b.jsxs)("div",{className:"w-100 md:w-[82%] md:h-[90vh] md:overflow-y-scroll fixed z-10 my-5 bg-white border-2 border-gray-500 shadow-md mx-[2%] md:mx-[10%]",children:[(0,b.jsxs)("span",{className:"flex justify-between border-b-2 border-gray-500 text-sm md:text-base py-1 px-1 font-semibold",children:[(0,b.jsxs)("span",{children:["Image Preview",(0,b.jsx)("span",{className:"md:invisible",children:" (Pinch to zoom)"})]}),(0,b.jsx)(y.FU5,{className:"text-right text-gray-700 right-0 text-2xl cursor-pointer",onClick:function(){V(),document.getElementById("imgpreview").style.opacity="1",document.getElementById("imgpreview2").style.display="block",document.body.style.overflow="scroll"}})]}),(0,b.jsx)("img",{src:U,alt:"Dialog Image",width:"100%"})]}),(0,b.jsx)("div",{className:"dark:bg-gray-900",children:(0,b.jsx)("div",{className:"py-5 mx-7 ",id:"imgpreview",onClick:function(e){var t=e.target.currentSrc;if(U&&!t)return V(),document.getElementById("imgpreview").style.opacity="1",document.getElementById("imgpreview2").style.display="block",void(document.body.style.overflow="scroll");t&&(document.getElementById("imgpreview").style.opacity="0.5",document.getElementById("imgpreview2").style.display="none",document.body.style.overflow="hidden",V(t))},children:t&&(0,b.jsxs)("div",{className:"min-h-screen lg:mx-[20%] md:mx-[10%]",children:[(0,b.jsxs)("h1",{className:"text-2xl lg:text-3xl flex font-semibold dark:text-white",children:[t.title,X&&(0,b.jsx)("a",{href:"/dashboard/blogpost/"+o,target:"_blank",rel:"noreferrer",children:(0,b.jsx)(p.z2D,{})})]}),(0,b.jsx)("div",{className:"cont font-karla dark:text-gray-300 mt-2",dangerouslySetInnerHTML:{__html:k}}),(0,b.jsx)("hr",{className:"mt-10"}),(0,b.jsx)("div",{className:"flex items-center justify-center shadow-lg mt-10 border mb-7 max-w-lg rounded-lg dark:border-black ",children:(0,b.jsx)("form",{className:"w-full max-w-xl bg-white rounded-lg px-4 pt-2 dark:bg-slate-700",onSubmit:$,children:(0,b.jsxs)("div",{className:"flex flex-wrap -mx-3 mb-6",children:[(0,b.jsx)("h2",{className:"px-4 pt-3 pb-2 text-gray-800 text-lg dark:text-gray-300",children:"Add a new comment"}),(0,b.jsx)("div",{className:"w-full md:w-full px-3 mb-2 mt-2",children:(0,b.jsx)("textarea",{value:w.comment,onChange:Q,className:"bg-gray-100 rounded border border-gray-400 leading-normal resize-none w-full h-20 py-2 px-3 font-medium placeholder-gray-700 focus:outline-none focus:bg-white dark:bg-slate-600 dark:text-gray-200 dark:placeholder-gray-400",name:"comment",placeholder:"Type Your Comment",required:!0})}),(0,b.jsx)("div",{className:"w-full md:w-full flex items-start px-3",children:(0,b.jsx)("div",{className:"-mr-1",children:(0,b.jsx)("input",{type:"submit",className:"disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-default text-white bg-purple-700 hover:bg-purple-800 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg text-sm px-3 py-2 text-center inline-flex items-center mx-1 cursor-pointer ",value:"Post Comment"})})})]})})}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("h3",{className:"mb-2 text-2xl font-semibold dark:text-gray-300",children:["Comments (",C,")"]}),(0,b.jsx)("hr",{className:"mb-1"}),0==C&&(0,b.jsx)("div",{className:"m-3",children:"No comments found"}),(0,b.jsx)(m.Z,{dataLength:B.length,next:G,hasMore:B.length!==C,loader:(0,b.jsx)("div",{className:"flex items-center justify-center mt-6",children:(0,b.jsx)("div",{className:"inline-flex max-w-4xl mx-auto items-center px-4 py-2 leading-6 transition ease-in-out duration-150 cursor-not-allowed",children:(0,b.jsxs)("svg",{className:"animate-spin h-8 w-8 text-purple-700",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}),children:B.map((function(e){return(0,b.jsx)("div",{className:"max-w-screen-sm px-4",children:(0,b.jsxs)("div",{className:"flex my-3 ",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"mt-2 rounded-full w-8 h-8 sm:w-10 sm:h-10"})}),(0,b.jsxs)("div",{className:"flex-1 border rounded-lg px-4 py-2 sm:px-6 sm:py-4 leading-relaxed max-w-[75vw] break-words dark:bg-slate-700 dark:border-black",children:[(0,b.jsx)("strong",{className:"dark:text-gray-200",children:e.user}),(0,b.jsx)("span",{className:"text-xs text-gray-500 ml-2 dark:text-gray-400",children:e.createdAt.slice(0,10)}),(0,b.jsx)("div",{className:"flex",children:(0,b.jsx)("p",{className:"text-sm mt-1 dark:text-gray-100",children:e.comment})}),q&&q.map((function(t){return e._id==t&&(0,b.jsx)("div",{className:"flex space-x-4",children:(0,b.jsx)("button",{className:"my-3 uppercase tracking-wide text-gray-400 font-bold text-xs cursor-pointer",onClick:function(){K(e._id)},children:"View all replies"})},t)})),z&&z.map((function(t){return e._id==t.parent&&(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"mt-3 rounded-full w-6 h-6 sm:w-8 sm:h-8"})}),(0,b.jsxs)("div",{className:"flex-1 bg-gray-100 mb-4 rounded-lg px-4 py-2 sm:px-6 sm:py-4 leading-relaxed dark:bg-slate-500 dark:text-gray-200",children:[(0,b.jsx)("strong",{children:t.user}),(0,b.jsx)("span",{className:"text-xs text-gray-500 ml-2 ",children:t.createdAt.slice(0,10)}),(0,b.jsx)("p",{className:"text-xs sm:text-sm ",children:t.comment})]})]})},t._id)})),(0,b.jsx)("button",{className:"mt-3 uppercase tracking-wide text-white bg-purple-600 rounded p-2 font-bold text-xs cursor-pointer ".concat(H.state?"block":"hidden"),onClick:function(){J({state:!1,id:e._id})},children:"Reply"}),(0,b.jsx)("div",{className:"flex space-x-4",children:e._id==H.id&&(0,b.jsxs)("form",{onSubmit:$,className:"flex ".concat(H.state?"hidden":"block"),id:e._id,children:[(0,b.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,b.jsx)("img",{src:"/img/user.png",alt:"",className:"rounded-full w-6 h-6 sm:w-8 sm:h-8"})}),(0,b.jsx)("input",{type:"text",className:"border pl-2 dark:text-white",name:"reply",value:w.reply,onChange:Q}),(0,b.jsx)("button",{type:"submit",className:"disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-default ml-2 hover:bg-purple-800 uppercase tracking-wide text-white bg-purple-600 rounded p-2 font-bold text-xs cursor-pointer",children:"Post"}),(0,b.jsx)("div",{className:"mt-2 ml-2 text-gray-600 uppercase tracking-wide active:text-purple-600 font-bold text-xs cursor-pointer dark:text-gray-400",onClick:function(){J({state:!0,id:e._id})},children:"Cancel"})]})})]})]})},e._id)}))})]})]})})})]}):(0,b.jsx)(f.default,{statusCode:404})}},8133:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogpost/[slug]",function(){return r(8386)}])}},function(e){e.O(0,[556,228,353,189,993,774,888,179],(function(){return t=8133,e(e.s=t);var t}));var t=e.O();_N_E=t}]);